# Reading and Writing data between Python and Teradata

## Local Python environment setup

For this run through I am using:

- Python 3.8.10
- installed on Windows Subsystem for Linux

Create a new virtual environment and install the requirements.

```sh
python3 -m venv tdml
pip install -r requirements.txt
python3 -m ipykernel install --user --name tdml --display-name tdml
```

## Teradata

I am using a Teradata Express 16.20 virtual machine running with VMWare Workstation Player 16.2.5.
Our hosts file is mapping the virtual machine's IP address to `tdvm`

```conf
 cat /etc/hosts
# This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:
# [network]
# generateHosts = false
127.0.0.1       localhost
192.168.190.128 tdv
```

### Setup database structures

This step is oviously not required, however it is here for completeness sake.
Running the `teradata-setup.sql` script to create the required database and provide access to the appropriate user.

### Setup the table structures

Runing this (`python-nfl-ddl.sql`) SQL script in you favourite SQL IDE (for example Teradata Studio).

![](./docs/teradata-tables.png)

## Python execution in VSCode

I'm going to using Python interactive in VSCode to run this. In this mode we can run the "Cells" (blocks of code between `# %%` seperately and view tabular results in a more visual way).

![](./docs/python-nfl-tables.png)

![](./docs/python-player-table.png)
